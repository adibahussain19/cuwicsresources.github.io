<html>
  <head>
    <meta charset="utf-8"/>
  </head>
  <body>
    <!-- References -->
    <!-- Code is based on the following resources:
         https://pages.github.com/
         https://firebase.google.com/docs/web/setup
         https://firebase.google.com/docs/firestore/quickstart
         https://codelabs.developers.google.com/codelabs/firebase-web/#0 -->

    <!--
         Copyright 2015 Google Inc. All Rights Reserved.
         Licensed under the Apache License, Version 2.0 (the "License");
         you may not use this file except in compliance with the License.
         You may obtain a copy of the License at
               http://www.apache.org/licenses/LICENSE-2.0
         Unless required by applicable law or agreed to in writing, software
         distributed under the License is distributed on an "AS IS" BASIS,
         WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
         See the License for the specific language governing permissions and
         limitations under the License.
      -->
    
    <h1>Firestore example</h1>

      <form id="message-form" action="#">
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
          <label class="mdl-textfield__label" for="message">Message to store in Firestore: </label>
          <input class="mdl-textfield__input" type="text" id="message" autocomplete="off">
        </div>
        <button id="submit" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">
          Send
        </button>
      </form>

    <!-- Import and configure the Firebase SDK -->
    <!-- These scripts are made available when the app is served or deployed on Firebase Hosting -->
    <!-- If you do not want to serve/host your project using Firebase Hosting see https://firebase.google.com/docs/web/setup -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-firestore.js"></script>
    
    <script>
      // Initialize Cloud Firestore through Firebase
      // Your web app's Firebase configuration
      var firebaseConfig = {
        apiKey: "",
        authDomain: "",
        databaseURL: "",
        projectId: "",
        storageBucket: "",
        messagingSenderId: "",
        appId: "",
        measurementId: ""
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();

      var db = firebase.firestore();
    </script>

    <script>
      var messageFormElement = document.getElementById('message-form');
      var messageInputElement = document.getElementById('message');
      var submitButtonElement = document.getElementById('submit');

      // Triggered when the send new message form is submitted.
      function onMessageFormSubmit(e) {
        e.preventDefault();
          // Check that the user entered a message 
        if (messageInputElement.value) {
          writeToFirestore(messageInputElement.value); 
        }
      }

      // Write messageText to Firestore
      function writeToFirestore(messageText) {
        db.collection("userMessages").add({
          message: messageText,
        })
        .then(function(docRef) {
          console.log("Document written with ID: ", docRef.id);
        })
        .catch(function(error) {
          console.error("Error adding document: ", error);
        });
      }

      messageFormElement.addEventListener('submit', onMessageFormSubmit);
    </script>

  </body>
</html>
